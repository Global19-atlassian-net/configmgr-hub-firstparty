<sequence version="3.10"><step type="SMS_TaskSequence_SetVariableAction" name="README" description="" runIn="WinPEandFullOS" successCodeList="0" retryCount="0" runFromNet="false"><action>tsenv.exe "README=This task sequence demonstrates querying battery state from WMI class Win32_Battery, if the device is using battery then the step is skipped. This can also be achieved with the Check Readiness step. In many cases it's preferable to have devices on AC power during upgrade/deployment. For more information see https://docs.microsoft.com/en-us/mem/configmgr/osd/understand/using-task-sequence-variables &amp; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-battery" /hiddenflag:False</action><defaultVarList><variable name="DoNotShowVariableValue" property="DoNotShowVariableValue" hidden="true">false</variable><variable name="VariableName" property="VariableName" hidden="true">README</variable><variable name="VariableValue" property="VariableValue" hidden="true">This task sequence demonstrates querying battery state from WMI class Win32_Battery, if the device is using battery then the step is skipped. This can also be achieved with the Check Readiness step. In many cases it's preferable to have devices on AC power during upgrade/deployment. For more information see https://docs.microsoft.com/en-us/mem/configmgr/osd/understand/using-task-sequence-variables &amp; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-battery</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="Test for Battery - WMI Query Condition is set" description="Returns 0 if AC Powered, Returns 1 if Battery Powered" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><condition><expression type="SMS_TaskSequence_WMIConditionExpression"><variable name="Namespace">root\cimv2</variable><variable name="Query">Select * from Win32_Battery where BatteryStatus != 2</variable></expression></condition><action>smsswd.exe /run: cmd.exe</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">cmd.exe</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">false</variable><variable name="SMSTSRunCommandLineOutputVariableName" property="OutputVariableName"></variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step></sequence>
